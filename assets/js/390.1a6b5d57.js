(window.webpackJsonp=window.webpackJsonp||[]).push([[390],{758:function(t,s,e){"use strict";e.r(s);var a=e(47),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"资源-resource-及相关"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#资源-resource-及相关"}},[t._v("#")]),t._v(" 资源（Resource）及相关")]),t._v(" "),e("h2",{attrs:{id:"uri-和-url"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#uri-和-url"}},[t._v("#")]),t._v(" URI 和 URL")]),t._v(" "),e("p",[t._v("在原生 JDK 中，提供了 "),e("strong",[t._v("java.net.URI")]),t._v(" 和 "),e("strong",[t._v("java.net.URL")]),t._v(" 类，来标识资源的定位。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("#")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("URI")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("统一资源标志符（Uniform Resource "),e("strong",[t._v("Identifier")]),t._v("）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("strong",[t._v("URL")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("统一资源定位符（uniform Resource "),e("strong",[t._v("Location")]),t._v("）")])])])]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("相同点")]),t._v("：它们都能定位资源的位置，代表这个资源的位置信息。"),e("small",[t._v("就像经纬度一样可以表示你在世界的哪个角落。")])])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("不同点")]),t._v("："),e("strong",[t._v("URI")]),t._v(" 更宽泛、更高级也更抽象，而 "),e("strong",[t._v("URL")]),t._v(" 则更具体。URI 是 URL 的超集，URL 是 URI 的子集。")])])]),t._v(" "),e("p",[t._v("例如，数据库的 JDBC 连接是一个 URI 也是一个 URL：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("dbc:mysql://127.0.0.1:3306/scott?useSSL=false\n")])])]),e("p",[t._v("但是也有一些标识资源的方式，它是 URI ，但不是 URL ，例如 "),e("code",[t._v("urn:isbn:0-486-27557-4")]),t._v("，这个是一本书的 ISBN ，可以唯一标识这本书，它是 URI 但不是 URL 。")]),t._v(" "),e("h2",{attrs:{id:"resource-及其实现类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resource-及其实现类"}},[t._v("#")]),t._v(" Resource 及其实现类")]),t._v(" "),e("p",[t._v("在日常项目开发过程中，从 classpath 下加载一个配置文件"),e("small",[t._v("（并从中读取配置信息）")]),t._v("是一个常见需求。")]),t._v(" "),e("p",[t._v("Spring 提炼出 "),e("strong",[t._v("Resource")]),t._v("（资源）的概念，并围绕它提供了一系列的工具类，能方便地实现上述功能"),e("small",[t._v("（及其它功能）")]),t._v("。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Resource\n├── FileSystemResource\n├── FileUrlResource\n├── ClassPathResource\n├── UrlResource\n└── InputStreamResource\n    └── EncodedResource\n")])])]),e("p",[e("em",[e("strong",[t._v("InputStreamResource")])]),t._v(" 是 Resource 接口的子接口，其实现类 "),e("em",[e("strong",[t._v("EncodedResource")])]),t._v(" 支持通过 InputStream 生成 Resource 对象，并且可以设置编码。（其他 Resource 都是使用 ISO-8859-1 编码）")]),t._v(" "),e("p",[t._v("Resource 接口定义了『资源』的概念，其中常用方法有：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("实例方法")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("boolean exists()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("判断资源是否存在")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("File getFile()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("从资源中获得 File 对象")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("URI getURI()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("从资源中获得 URI 对象")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("URL getURL()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("从资源中获得 URI 对象")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("InputStream getInputStream()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("获得资源的 InputStream")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("String getDescription()")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("获得资源的描述信息")])])])]),t._v(" "),e("p",[e("small",[t._v("Resource 接口的各个实现类中除了上述方法外，还有自己的一些方法。")])]),t._v(" "),e("h2",{attrs:{id:"resource-的-getfile-方法的一个问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resource-的-getfile-方法的一个问题"}},[t._v("#")]),t._v(" Resource 的 getFile() 方法的一个问题")]),t._v(" "),e("p",[t._v("Resource 的 "),e("em",[t._v("getFile()")]),t._v(" 方法需要 Resource 对象所代表的那个文件 "),e("strong",[t._v("在文件系统中是独立存在的！")])]),t._v(" "),e("p",[t._v("因此，你在 Eclipse/Idea 源码运行中运行，或者是一个 "),e("em",[t._v(".war")]),t._v(" 的项目在 tomcat 下运行，"),e("em",[t._v(".getFile()")]),t._v(" 方法都是没有任何问题，能正常起作用：获得 File 对象。")]),t._v(" "),e("p",[t._v("但是，在 Spring Boot 中，"),e("em",[t._v(".getFile()")]),t._v(" 方法无法获得 File 对象。因为，Spring Boot 的 "),e("em",[t._v(".jar")]),t._v(" 包不像一般 Java Web 的 "),e("em",[t._v(".war")]),t._v(" 那样会被 tomcat 解压开!")]),t._v(" "),e("p",[t._v("因此，Spring Boot 项目中的资源文件都是 "),e("strong",[t._v("内嵌")]),t._v(" 在 "),e("em",[t._v(".jar")]),t._v(" 包中，而非独立存在的。不满足 "),e("em",[t._v(".getFile()")]),t._v(" 的那个前提要求。")]),t._v(" "),e("p",[t._v("Spring Boot 的这种场景下，需要 "),e("strong",[t._v("使用 "),e("em",[t._v(".getInputStream()")]),t._v(" 方法来替代 "),e("em",[t._v(".getFile()")]),t._v(" 方法")]),t._v(" 。")]),t._v(" "),e("p",[t._v("简而言之，Resource 的 "),e("em",[t._v(".getInputStream()")]),t._v(" 方法比 "),e("em",[t._v(".getFile()")]),t._v(" 方法具有更好的普适性。")]),t._v(" "),e("h2",{attrs:{id:"resourceutils"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resourceutils"}},[t._v("#")]),t._v(" ResourceUtils")]),t._v(" "),e("p",[t._v("对于常见的 new Resource() 对象 + 操作 Resource 对象 的常见使用方式，Spring 提供了一个 "),e("em",[e("strong",[t._v("ResourceUtils")])]),t._v(" 类来简化这样的代码。")]),t._v(" "),e("p",[e("em",[e("strong",[t._v("ResourceUtils")])]),t._v(" 类位于 "),e("em",[t._v("org.springframework.util")]),t._v(" 包。它用于处理表达资源字符串前缀描述资源的工具. 如: "),e("em",[t._v("classpath:")]),t._v("、"),e("em",[t._v("file:")]),t._v(" 等。")]),t._v(" "),e("p",[t._v("不过，ResourceUtils 类也有上面所说的那个 "),e("em",[t._v(".getFile()")]),t._v(" 的问题。因此，如果是 Spring Boot 项目，还是少用/不用 ResourceUtils 的 "),e("em",[t._v(".getFile()")]),t._v(" 方法。")]),t._v(" "),e("p",[t._v("ResourceUtils 的常用方法：")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断字符串是否是一个合法的 URL 字符串。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUrl")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" resourceLocation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getURL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" resourceLocation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),t._v("\t"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" resourceLocation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URI")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toURI")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URL")]),t._v(" url"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),t._v("\t"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URI")]),t._v(" resourceUri"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),t._v("\t"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URL")]),t._v(" resourceUrl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"propertiesloaderutils"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#propertiesloaderutils"}},[t._v("#")]),t._v(" PropertiesLoaderUtils")]),t._v(" "),e("p",[e("em",[t._v(".properties")]),t._v(" 文件是最常见的资源文件。对此，Spring 框架提供了 "),e("em",[e("strong",[t._v("PropertiesLoaderUtils")])]),t._v(" 工具类来简化加载 "),e("em",[t._v(".properties")]),t._v(" 配置类的工作。")]),t._v(" "),e("p",[e("small",[e("em",[e("strong",[t._v("PropertiesLoaderUtils")])]),t._v(" 位于 "),e("em",[t._v("org.springframework.core.io.support")]),t._v(" 包下。")])]),t._v(" "),e("p",[e("small",[t._v("以下方法都是 "),e("em",[t._v("static")]),t._v(" 方法")])]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查找资源，并生成 Properties 对象。使用 ISO-8859-1 编码。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Properties")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadProperties")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Resource")]),t._v(" resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 classpath 中查找资源，并生成 Properties 对象。使用 ISO-8859-1 编码。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Properties")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadAllProperties")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" resourceName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查找资源，并生成 Properties 对象。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Properties")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadProperties")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EncodedResource")]),t._v(" resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查找资源，填充参数对象。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fillProperties")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Properties")]),t._v(" props"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Resource")]),t._v(" resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查找资源，填充参数对象。")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fillProperties")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Properties")]),t._v(" props"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EncodedResource")]),t._v(" resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);