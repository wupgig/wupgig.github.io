(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{552:function(t,a,s){"use strict";s.r(a);var n=s(47),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"几个常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#几个常见问题"}},[t._v("#")]),t._v(" 几个常见问题")]),t._v(" "),s("h2",{attrs:{id:"maven-archetype-webapp-骨架的-servlet-版本问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#maven-archetype-webapp-骨架的-servlet-版本问题"}},[t._v("#")]),t._v(" maven-archetype-webapp 骨架的 Servlet 版本问题")]),t._v(" "),s("p",[t._v("通过 "),s("strong",[t._v("maven-archetype-webapp")]),t._v(" 骨架去创建 java web 项目时，自动生成的 "),s("em",[t._v("web.xml")]),t._v(" 配置文件所使用的 Servlet 的版本比较低"),s("small",[t._v("（2.3）")]),t._v("，而在低版本的 Servlet 中 EL 表达式默认是关闭的。")]),t._v(" "),s("p",[t._v("通常，我们使用的 Servlet 至少会是 "),s("strong",[t._v("3.1")]),t._v(" 。")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("web-app")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://xmlns.jcp.org/xml/ns/javaee"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xsi:")]),t._v("schemaLocation")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://xmlns.jcp.org/xml/ns/javaee\n      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("3.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  ...\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("web-app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h2",{attrs:{id:"lastupdated-文件问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lastupdated-文件问题"}},[t._v("#")]),t._v(" .lastUpdated 文件问题")]),t._v(" "),s("p",[s("strong",[t._v(".lastUpdated")]),t._v(" 文件是 Maven 在下载依赖包时的中间文件。例如：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("slf4j-api-1.7.5.pom.lastUpdated\nsurefire-junit4-2.12.4.jar.lastUpdated\n")])])]),s("p",[t._v("在下载成功完成后，"),s("strong",[t._v(".lastUpdated")]),t._v(" 文件会被移除，成功下载的包文件将会出现。")]),t._v(" "),s("p",[t._v("当你发现你的本地仓库中的某个包的目录下存在 "),s("strong",[t._v(".lastUpdated")]),t._v(" 文件，那么这意味着发生了以下 2 种情况之一：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Maven 正在下载这个包。"),s("small",[t._v("通常不会是这个情况，因为配置国内的中央仓库镜像后，下载包的速度较快，再加上各个包实际并不大，这种情况的 .lastUpdated 文件只存在极短的一瞬间，不会让你『长期看到』它。")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("上一次 maven 下载这个包时失败，而遗留下来的")]),t._v("，通常你可能『长期看到』一个 .lastUpdated 文件就是因为这个原因。")])])]),t._v(" "),s("p",[t._v("如果是第二种情况，则会给你带来麻烦：因为 maven 不支持断点续传，而 "),s("strong",[t._v(".lastUpdated")]),t._v(" 文件既不可用，又会导致 maven 不会重新下载。")]),t._v(" "),s("p",[t._v("因此，理论上，你要清除掉你本地仓库中的 "),s("em",[t._v(".lastUpdated")]),t._v(" 文件，以免它干扰你的 maven 的正常使用。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("cleanLastUpdated.bat")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("@echo off\n\nrem 这里写你的仓库路径\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("REPOSITORY_PATH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("C:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Users"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(".m2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("repository\nrem 正在搜索"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" /f "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"delims="')]),t._v(" %%i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dir /b /s \"%REPOSITORY_PATH%\\*lastUpdated*\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" %%i\n    del /s /q "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%%i"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrem 搜索完毕\npause\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"idea-maven-默认使用-jdk-1-5-编译问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#idea-maven-默认使用-jdk-1-5-编译问题"}},[t._v("#")]),t._v(" IDEA Maven 默认使用 JDK 1.5 编译问题")]),t._v(" "),s("p",[t._v("IDEA 在『调用』maven 时，IDEA 默认都会采用 JDK 1.5 编译，不管你安装的 JDK 版本是 JDK 7 还是 JDK 8 或者更高。"),s("small",[t._v("这样一来非常不方便，尤其是时不时使用 JDK 7/8 的新特性时。如果使用新特性，编译器直接报错。")])]),t._v(" "),s("p",[t._v("对于此类问题，解决办法不止一种。Maven 官方推荐做法是固定 JDK 的编译版本。")]),t._v(" "),s("p",[t._v("需要在 "),s("strong",[t._v("pom.xml")]),t._v(" 文件中加入：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("java.version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("java.version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("maven.compiler.source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("maven.compiler.source")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("maven.compiler.target")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("maven.compiler.target")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h2",{attrs:{id:"tomcat7-maven-plugin-版本『低』的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat7-maven-plugin-版本『低』的问题"}},[t._v("#")]),t._v(" tomcat7-maven-plugin 版本『低』的问题")]),t._v(" "),s("p",[t._v("相较于当前最新版的 tomcat 10 而言，tomcat7-maven-plugin 确实看起来很显老旧。但是，这个问题并不是问题，至少不是大问题。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("tomcat7-maven-plugin 仅用于我们"),s("small",[t._v("（程序员）")]),t._v("开发环境中，最终项目交付以后的运行环境，是 tomcat7 还是更高版本的 tomcat，甚至是其它的 Servlet 容器，这就是另一个问题了，这和 tomcat7-maven-plugin 的版本无关。")])]),t._v(" "),s("li",[s("p",[t._v("tomcat7 支持 Servlet 3.0，tomcat8 支持 Servlet 3.1，实际上 Servlet 3.0 和 3.1 的区别并不大，甚至说，从 Servlet 3.0 开始，tomcat 的新特性在绝大多数的项目中都用不少，所以，tomcat8-maven-plugin 的高级也没高到哪里去。")]),t._v(" "),s("blockquote",[s("p",[s("small",[t._v("这里涉及到一个小知识，从 3.1 开始，Servlet 开始内置了文件上传功能。但是，经测试实际上，3.0 就已经有了这个功能。另外，Servlet 内置的上传功能，在上传文件名是中文的文件是有中文乱码问题，不是很好解决。所以，实际上上传文件的方案，还是 commons-fileupload 更常见，Servlet 3.0 开始出现的内置的上传方案并没有那么美好。")])])])]),t._v(" "),s("li",[s("p",[t._v("tomcat7-maven-plugin 是 tomcat-maven-plugin 的子项目，tomcat-maven-plugin 的最高版本是 2.2 ，版本新特性就是支持 tomcat7 。也就是说 tomcat8-maven-plugin 并非官方项目，这也是为什么，中央仓库没中 tomcat8-maven-plugin 的原因。")]),t._v(" "),s("blockquote",[s("p",[s("small",[t._v("如果对 tomcat7 的版本仍疑虑，也不一定非要使用非官方的 tomcat8-maven-plugin。可以使用其它的 Servlet 容器的 maven 插件，例如 jetty 。")])])])])]),t._v(" "),s("h2",{attrs:{id:"mirrorof-是-central-还是-的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mirrorof-是-central-还是-的问题"}},[t._v("#")]),t._v(" mirrorOf 是 central 还是 * 的问题")]),t._v(" "),s("p",[t._v("在配置阿里对官方中央仓库的镜像服务器时，我们使用到了 "),s("strong",[t._v("<mirror>")]),t._v(" 元素。")]),t._v(" "),s("p",[t._v("故名思意，"),s("strong",[t._v("<mirror>")]),t._v(" 用于配置网络仓库的『"),s("strong",[t._v("镜像")]),t._v("』。当你准备去默认的中央仓库下载包和插件时，Maven 会『"),s("strong",[t._v("拦截")]),t._v("』你的下载请求，转而去你所配置的『"),s("strong",[t._v("镜像网址")]),t._v("』下载，从而也能实现从指定的国内的网址下载。")]),t._v(" "),s("p",[t._v("而 "),s("em",[t._v("<mirror>")]),t._v(" 元素的子元素 "),s("strong",[t._v("<mirrorOf>")]),t._v(" 的值常见两种："),s("strong",[t._v("central")]),t._v(" 和通配符 "),s("strong",[t._v("*")]),t._v(" 。")]),t._v(" "),s("p",[t._v("central 和 * 的区别在于：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("如果是 "),s("strong",[t._v("central")]),t._v("，那么 maven 只会将你的从『"),s("strong",[t._v("中央仓库")]),t._v("』下载请求"),s("small",[t._v("（无论是 jar 包，还是插件包）")]),t._v("，转向你所配置的镜像地址。")])]),t._v(" "),s("li",[s("p",[t._v("如果是 "),s("strong",[t._v("*")]),t._v(" ，那么 maven 会将你的『"),s("strong",[t._v("所有")]),t._v("』下载请求转向你所配置的镜像地址。")])])]),t._v(" "),s("p",[t._v("如果你要下载一个不在中央仓库的包"),s("small",[t._v("（或插件）")]),t._v("，例如 "),s("strong",[t._v("tomcat8-maven-plugin")]),t._v(" ，")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("如果你配置的值是 "),s("strong",[t._v("central")]),t._v("，那么 maven 会去你所配置的『别的』仓库下载，因为中央仓库没有这个包；")])]),t._v(" "),s("li",[s("p",[t._v("如果你配置的值是 "),s("strong",[t._v("*")]),t._v("，那么无论这个包在不在中央仓库，maven 只会去中央仓库下载。有，则有；没有，则没有。")])])]),t._v(" "),s("h2",{attrs:{id:"高版本的-lombok-和-tomcat-7-插件冲突问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高版本的-lombok-和-tomcat-7-插件冲突问题"}},[t._v("#")]),t._v(" 高版本的 lombok 和 tomcat 7 插件冲突问题")]),t._v(" "),s("p",[t._v("在开发期间，当我们使用 "),s("strong",[t._v("tomcat7-maven-plugin")]),t._v(" 来作为运行环境运行我们项目使，如果我们项目中使用了 "),s("strong",[t._v("1.16.20")]),t._v(" 及以上版本的 lombok 包，项目启动时会报错：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("for annotations org.apache.tomcat.util.bcel.classfile.ClassFormatException: Invalid byte tag in constant pool: 19\n")])])]),s("p",[t._v("原因在于，从 "),s("strong",[t._v("1.16.20")]),t._v(" 开始 lombok 包中有了一个叫 "),s("strong",[t._v("module-info.class")]),t._v(" 的文件，而低版本的 tomcat 不能识别这个文件，从而导致运行时出错。")]),t._v(" "),s("blockquote",[s("p",[t._v("其实这个问题对于我们而言不是问题，因为项目部署时，肯定不会部署到 tomcat 7 上，至少是 tomcat 8.5 。")])]),t._v(" "),s("p",[t._v("对于这个问题，解决办法有 2 个：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("使用 tomcat8-maven-plugin 。")])]),t._v(" "),s("li",[s("p",[t._v("将 lombok 的 "),s("code",[t._v("<scope>")]),t._v(" 设置为 "),s("code",[t._v("provided")]),t._v("，这样，maven 在打包时就不会将 lombok 包含在 jar/war 包内。"),s("small",[t._v("我们对 lombok 的使用也就是在编译时使用，运行时不需要它。")])])]),t._v(" "),s("li",[s("p",[t._v("使用低版本的 lombok，例如，"),s("code",[t._v("1.14.x")]),t._v(" 的最高版本 "),s("code",[t._v("1.14.8")]),t._v(" 。")])])]),t._v(" "),s("h2",{attrs:{id:"hibernate-validator-高版本问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hibernate-validator-高版本问题"}},[t._v("#")]),t._v(" hibernate-validator 高版本问题")]),t._v(" "),s("p",[t._v("hibernate-validator 的高版本"),s("small",[t._v("（邮箱注解）")]),t._v("依赖于高版本的 el-api，tomcat 8 的 el-api 是 3.0，满足需要。但是 tomcat 7 的 el-api 只有 2.2，不满足其要求。")]),t._v(" "),s("p",[t._v("解决办法有 2 种：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("低版本如 "),s("strong",[t._v("5.4.3.Final")]),t._v(" 在 tomcat7-maven-plugin 上可用。")])]),t._v(" "),s("li",[s("p",[t._v("使用 tomcat8-maven-plugin 。")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);